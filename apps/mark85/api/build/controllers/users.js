(function(_0x37b92a,_0x4fa7a7){const _0x3b1f22=a2_0x4ccd,_0x408b4d=_0x37b92a();while(!![]){try{const _0x38d8b7=-parseInt(_0x3b1f22(0xb6))/0x1*(-parseInt(_0x3b1f22(0xcb))/0x2)+parseInt(_0x3b1f22(0xc9))/0x3+-parseInt(_0x3b1f22(0xbc))/0x4+-parseInt(_0x3b1f22(0xbf))/0x5*(parseInt(_0x3b1f22(0xba))/0x6)+-parseInt(_0x3b1f22(0xbd))/0x7*(parseInt(_0x3b1f22(0xb5))/0x8)+parseInt(_0x3b1f22(0xb7))/0x9*(parseInt(_0x3b1f22(0xc7))/0xa)+parseInt(_0x3b1f22(0xbe))/0xb*(-parseInt(_0x3b1f22(0xc8))/0xc);if(_0x38d8b7===_0x4fa7a7)break;else _0x408b4d['push'](_0x408b4d['shift']());}catch(_0xaa6134){_0x408b4d['push'](_0x408b4d['shift']());}}}(a2_0x2aa8,0x7b440));function a2_0x2aa8(){const _0x486ef4=['findOne','24jNLAxi','4McIZwp','45MnovlX','password','ValidationError','6QoUvfj','end','2859784JoTOYS','1964886AxVfzV','66SyblIn','770395nCIbWi','hash','status','save','name','body','json','10d','1094620JfCgsa','12228HjAdQV','2870793nQhZIF','qax','358944lyvVRV'];a2_0x2aa8=function(){return _0x486ef4;};return a2_0x2aa8();}import a2_0x543231 from'../models/user';function a2_0x4ccd(_0x581f38,_0x290da9){const _0x2aa843=a2_0x2aa8();return a2_0x4ccd=function(_0x4ccd8b,_0x52f34d){_0x4ccd8b=_0x4ccd8b-0xb5;let _0x21d776=_0x2aa843[_0x4ccd8b];return _0x21d776;},a2_0x4ccd(_0x581f38,_0x290da9);}import a2_0x210bb9 from'bcrypt';import a2_0x2e5a22 from'jsonwebtoken';export default{'auth':async(_0x438c8c,_0x3275c4)=>{const _0x1ef557=a2_0x4ccd,{email:_0x44e2e3,password:_0x38748b}=_0x438c8c[_0x1ef557(0xc4)],_0x46edcc=await a2_0x543231['findOne']({'email':_0x44e2e3});if(!_0x46edcc)return _0x3275c4[_0x1ef557(0xc1)](0x191)[_0x1ef557(0xbb)]();if(!await a2_0x210bb9['compare'](_0x38748b,_0x46edcc[_0x1ef557(0xb8)]))return _0x3275c4['status'](0x191)[_0x1ef557(0xbb)]();const {id:_0x4ffb0f}=_0x46edcc;return _0x3275c4[_0x1ef557(0xc5)]({'user':_0x46edcc,'token':a2_0x2e5a22['sign']({'id':_0x4ffb0f,'user':_0x46edcc},_0x1ef557(0xca),{'expiresIn':'10d'}),'expires_in':_0x1ef557(0xc6)});},'create':async(_0x4040ab,_0x46d4b9)=>{const _0x342135=a2_0x4ccd,{name:_0x14914a,email:_0x45a34b,password:_0x4beb8a}=_0x4040ab['body'],_0x469016=await a2_0x543231[_0x342135(0xcc)]({'email':_0x45a34b});if(_0x469016)return _0x46d4b9[_0x342135(0xc1)](0x199)['json']({'message':'Duplicated\x20email!'});const _0x5a334c=await a2_0x210bb9[_0x342135(0xc0)](_0x4beb8a,0x8),_0x9091c={'name':_0x14914a,'email':_0x45a34b,'password':_0x5a334c};try{let _0x5ddbc1=new a2_0x543231(_0x9091c);const _0x40d902=await _0x5ddbc1[_0x342135(0xc2)]();return _0x46d4b9['status'](0xc8)[_0x342135(0xc5)](_0x40d902);}catch(_0x5b700d){if(_0x5b700d[_0x342135(0xc3)]===_0x342135(0xb9))return _0x46d4b9[_0x342135(0xc1)](0x190)[_0x342135(0xc5)](_0x5b700d);return _0x46d4b9['status'](0x1f4)[_0x342135(0xc5)](_0x5b700d);}}};